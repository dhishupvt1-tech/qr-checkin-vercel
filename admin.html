<!DOCTYPE html>
<html>
<head><title>Admin</title></head>
<body>

<h2>Attendees</h2>
<ul id="list"></ul>

<script>

const supabase = supabasejs.createClient(
  "https://qwumwbmystwwhsjpllqn.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF3dW13Ym15c3R3d2hzanBsbHFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0OTg0OTUsImV4cCI6MjA4NjA3NDQ5NX0.Pd9xovSIz0GwsZXBj1w79fe9HfsRCv1ZtWbkJ-Umh8M"
);

supabase.auth.getUser().then(({ data }) => {
  if (!data.user) {
    window.location.href = "login.html";
  }
});

const SUPABASE_URL = "https://qwumwbmystwwhsjpllqn.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF3dW13Ym15c3R3d2hzanBsbHFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA0OTg0OTUsImV4cCI6MjA4NjA3NDQ5NX0.Pd9xovSIz0GwsZXBj1w79fe9HfsRCv1ZtWbkJ-Umh8M";

fetch(`${SUPABASE_URL}/rest/v1/attendees`, {
  headers: {
    apikey: SUPABASE_KEY,
    Authorization: "Bearer " + SUPABASE_KEY
  }
})
.then(res => res.json())
.then(data => {
  const list = document.getElementById("list");
  data.forEach(a => {
    list.innerHTML += `<li>${a.name} - ${a.checked_in ? "✔️" : "❌"}</li>`;
  });
});
</script>
</body>
</html>
